<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vertical Family Tree</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;700&display=swap');

        .node rect {
            fill: #fff;
            stroke: steelblue;
            stroke-width: 1.5px;
        }
        .node text {
            font-family: 'Noto Naskh Arabic', sans-serif;

        }
        .link {
            fill: none;
            stroke: #040404;
            stroke-width: 2px;
        }
        .node:hover {
            cursor: pointer;
        }
        .node.has-children rect {
            fill: lightblue;
        }

        .node.collapsed rect {
            fill: blue;
        }

        #tree-container {
            overflow-x: auto;
            overflow-y: auto;
            width: 100%;
            height: 100%;
        }
        svg {
            width: 10000px;
            height: 10000px;
        }
        
    </style>
</head>
<body>
    <div id="tree-container">
        <svg></svg>
    </div>
    <script>
        const data = {
            name: "سياط",
            children: [
                {
                    name: "سالم",
                    children: [
                        { name: "عودة" },
                        { name: "خلف" }
                    ]
                },
                {
                    name: "مختار",
                    children: [
                        {
                            name: "حمود",
                            children: [
                                {
                                    name: "راشد",
                                    children: [
                                        {
                                            name: "بريكان",
                                            children: [
                                                {
                                                    name: "مزيد",
                                                    children: [
                                                        { name: "حماد" },
                                                        { name: "راشد" }
                                                    ]
                                                },
                                                {
                                                    name: "زيدان",
                                                    children: [
                                                        { name: "أحمد" },
                                                        { name: "علي" }
                                                    ]
                                                },
                                                {
                                                    name: "زيد",
                                                    children: [
                                                        { name: "حمود" },
                                                        { name: "حسين" }
                                                    ]
                                                },
                                                {
                                                    name: "سليمان",
                                                    children: [
                                                        {
                                                            name: "مرزوق",
                                                            children: [
                                                                {
                                                                    name: "مسفر",
                                                                    children: [
                                                                        { name: "موسى" }
                                                                    ]
                                                                },
                                                                {
                                                                    name: "حماد",
                                                                    children: [
                                                                        {
                                                                            name: "مطير",
                                                                            children: [
                                                                                { name: "موسى" },
                                                                                { name: "يوسف" }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    name: "عجاج",
                                                                    children: [
                                                                        {
                                                                            name: "علي",
                                                                            children: [
                                                                                { name: "ماشي" },
                                                                                {
                                                                                    name: "محمد",
                                                                                    children: [
                                                                                        { name: "مرزوق" },
                                                                                        { name: "سليمان" },
                                                                                        { name: "يوسف" },
                                                                                        { name: "إبراهيم" },
                                                                                        { name: "صالح" },
                                                                                        { name: "علي" }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    name: "عجب",
                                                                    children: [
                                                                        {
                                                                            name: "سميحان",
                                                                            children: [
                                                                                {
                                                                                    name: "سعود",
                                                                                    children: [
                                                                                        { name: "طارق" },
                                                                                        {
                                                                                            name: "هاني",
                                                                                            children: [
                                                                                                { name: "معاذ" },
                                                                                                { name: "أسامة" },
                                                                                                { name: "معتز" },
                                                                                                { name: "مشاري" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "هيثم",
                                                                                            children: [
                                                                                                { name: "عبدالعزيز" },
                                                                                                { name: "سعود" }
                                                                                            ]
                                                                                        },
                                                                                        { name: "أسامة" },
                                                                                        {
                                                                                            name: "سامي",
                                                                                            children: [
                                                                                                { name: "نايف" },
                                                                                                { name: "سعود" },
                                                                                                { name: "خالد" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "أنس",
                                                                                            children: [
                                                                                                { name: "سلام" }
                                                                                            ]
                                                                                        },
                                                                                        { name: "عاصم" },
                                                                                        { name: "مصعب" }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    name: "صالح",
                                                                                    children: [
                                                                                        { name: "محمد" },
                                                                                        { name: "هشام" },
                                                                                        { name: "معتصم" },
                                                                                        { name: "عبدالملك" }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            name: "سحيمان",
                                                                            children: [
                                                                                { name: "موسى" },
                                                                                { name: "عبدالله" },
                                                                                { name: "علي" },
                                                                                { name: "عبدالرحمن" }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            name: "سالم",
                                                            children: [
                                                                {
                                                                    name: "فارس",
                                                                    children: [
                                                                        {
                                                                            name: "مطلق",
                                                                            children: [
                                                                                { name: "أحمد" }
                                                                            ]
                                                                        },
                                                                        { name: "فهيد" }
                                                                    ]
                                                                },
                                                                {
                                                                    name: "عطاالله",
                                                                    children: [
                                                                        {
                                                                            name: "عواد",
                                                                            children: [
                                                                                { name: "حنظول" },
                                                                                {
                                                                                    name: "عطاالله",
                                                                                    children: [
                                                                                        { name: "إبراهيم" },
                                                                                        { name: "خليل" },
                                                                                        { name: "ماجد" },
                                                                                        { name: "عواد" }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    name: "حنيظل",
                                                                    children: [
                                                                        { name: "سليمان" },
                                                                        {
                                                                            name: "سلمان",
                                                                            children: [
                                                                                {
                                                                                    name: "هلال",
                                                                                    children: [
                                                                                        {
                                                                                            name: "سلمان",
                                                                                            children: [
                                                                                                { name: "أديب" },
                                                                                                { name: "أمجد" },
                                                                                                { name: "مجدي" },
                                                                                                { name: "ماجد" },
                                                                                                { name: "عبدالمجيد" },
                                                                                                { name: "محمد" },
                                                                                                { name: "أحمد" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "عبدالرحمن",
                                                                                            children: [
                                                                                                { name: "حسام" },
                                                                                                { name: "سامر" },
                                                                                                { name: "باسم" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "يوسف",
                                                                                            children: [
                                                                                                { name: "مهند" },
                                                                                                { name: "هلال" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "موسى",
                                                                                            children: [
                                                                                                { name: "أحمد" },
                                                                                                { name: "عبدالله" },
                                                                                                { name: "محمد" },
                                                                                                { name: "خالد" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "محمد",
                                                                                            children: [
                                                                                                { name: "خالد" },
                                                                                                { name: "فيصل" },
                                                                                                { name: "نواف" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "بدر",
                                                                                            children: [
                                                                                                { name: "هلال" }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            name: "محمد",
                                                                            children: [
                                                                                {
                                                                                    name: "حمود",
                                                                                    children: [
                                                                                        { name: "عبدالهادي" },
                                                                                        { name: "عبدالرحمن" }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    name: "الحميدي",
                                                                                    children: [
                                                                                        {
                                                                                            name: "عبدالله",
                                                                                            children: [
                                                                                                { name: "سياط" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "محمد",
                                                                                            children: [
                                                                                                { name: "نواف" },
                                                                                                { name: "عبدالله" },
                                                                                                { name: "معن" },
                                                                                                { name: "فيصل" }
                                                                                            ]
                                                                                        },
                                                                                        { name: "خالد" },
                                                                                        { name: "بدر" }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            name: "خميس",
                                                                            children: [
                                                                                {
                                                                                    name: "عطاء",
                                                                                    children: [
                                                                                        {
                                                                                            name: "عبدالله",
                                                                                            children: [
                                                                                                { name: "فيصل" },
                                                                                                { name: "مساعد" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "خالد",
                                                                                            children: [
                                                                                                { name: "وليد" }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            name: "خميس",
                                                                                            children: [
                                                                                                { name: "إلياس" }
                                                                                            ]
                                                                                        },
                                                                                        { name: "أيمن" },
                                                                                        {
                                                                                            name: "محمد",
                                                                                            children: [
                                                                                                { name: "عبدالعزيز" },
                                                                                                { name: "عمر" },
                                                                                                { name: "حمد" }
                                                                                            ]
                                                                                        },
                                                                                        { name: "أحمد" },
                                                                                        { name: "عادل" },
                                                                                        { name: "أشرف" }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    name: "ونيس",
                                                                                    children: [
                                                                                        {
                                                                                            name: "ونيس",
                                                                                            children: [
                                                                                                { name: "أحمد" },
                                                                                                { name: "محمد" },
                                                                                                { name: "عبدالعزيز" },
                                                                                                { name: "خالد" },
                                                                                                { name: "نواف" }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                { name: "عبدالله" }
                                                                            ]
                                                                        },
                                                                        { name: "فويران" }
                                                                    ]
                                                                },
                                                                { name: "حنظول" }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    name: "فهيد",
                                                    children: [
                                                        { name: "صالح" }
                                                    ]
                                                },
                                                {
                                                    name: "فهد",
                                                    children: [
                                                        { name: "فهاد" },
                                                        { name: "عواد" }
                                                    ]
                                                }
                                            ]
                                        },
                                        { name: "مطلق" }
                                    ]
                                },
                                { name: "فهيد" }
                            ]
                        },
                        { name: "سلمان" }
                    ]
                },
                { name: "حماد" }
            ]
        };

        const margin = { top: 150, right: 20, bottom: 20, left: 300 };
        let width = 1200, height = 2000;

        let i = 0, duration = 750;

        const tree = d3.tree().nodeSize([120, 50]);

        const svg = d3.select("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        let root = d3.hierarchy(data, d => d.children);
        root.x0 = width / 2;
        root.y0 = 0;

        collapse(root);

        svg.append("text")
    .attr("x", root.x) // Center horizontally
    .attr("y", root.y0-110)
    .attr("text-anchor", "middle")
    .attr("font-family", 'Noto Naskh Arabic, sans-serif')
    .attr("font-size", "30px")
    .text("شجرة عشيرة السياط");

    svg.append("text")
    .attr("x", root.x) // Center horizontally
    .attr("y", root.y0-80)
    .attr("text-anchor", "middle")
    .attr("font-family", 'Noto Naskh Arabic, sans-serif')
    .attr("font-size", "20px")
    .text("من ذرية سياط بن عودة بن محمد بن علّيج بن محمد بن سليمان");

    svg.append("text")
    .attr("x", root.x) // Center horizontally
    .attr("y", root.y0-50)
    .attr("text-anchor", "middle")
    .attr("font-family", 'Noto Naskh Arabic, sans-serif')
    .attr("font-size", "20px")
    .text("بن نافع بن عمار بن زقروط الربيعي العبدي الشمري");

        function collapse(d) {
            if (d.children) {
                d._children = d.children;
                d._children.forEach(collapse);
                d.children = null;
            }
        }

        function expand(d) {
            if (d._children) {
                d.children = d._children;
                d.children.forEach(expand);
                d._children = null;
            }
        }

        function update(source) {
            const treeData = tree(root);
            const nodes = treeData.descendants();
            const links = treeData.descendants().slice(1);

            nodes.forEach(d => d.y = d.depth * 50);

            const minX = Math.min(...nodes.map(d => d.x)) - 200;
            const maxX = Math.max(...nodes.map(d => d.x)) + 200;
            const minY = Math.min(...nodes.map(d => d.y)) - 200;
            const maxY = Math.max(...nodes.map(d => d.y)) + 200;

            const svgWidth = maxX - minX + margin.left + margin.right;
            const svgHeight = maxY - minY + margin.top + margin.bottom;

            d3.select("svg")
                .attr("width", svgWidth)
                .attr("height", svgHeight);

            const node = svg.selectAll('g.node')
                .data(nodes, d => d.id || (d.id = ++i));

            const nodeEnter = node.enter().append('g')
                .attr('class', 'node')
                .attr('transform', d => `translate(${source.x0},${source.y0})`)
                .on('click', click);
                

            nodeEnter.append('rect')
                .attr('width', 100)
                .attr('height', 30)
                .attr('x', -50)
                .attr('y', -15)
                .attr('rx', 10)
                .attr('ry', 10)
                .attr('class', 'node')
                .style('fill', d => d._children ? "lightsteelblue" : "#fff");


            nodeEnter.append('text')
                .attr('dy', '.23em')
                .attr('x', 0)
                .attr('text-anchor', 'middle')
                .attr("font-family", 'Noto Naskh Arabic, sans-serif')
                .attr("font-size", "20px")
                .text(d => d.data.name);

            nodeEnter.append('text')
                .attr('dy', '.35em')
                .attr('x', 50)
                .attr('y', -15)
                .attr('text-anchor', 'start')
                .attr("font-family", 'Noto Naskh Arabic, sans-serif')
                .attr("font-size", "10px")
                .style('fill', 'red')
                .text(d => d.children || d._children ? `(${d.children ? d.children.length : d._children.length})` : '');

            const nodeUpdate = nodeEnter.merge(node);

            nodeUpdate.transition()
                .duration(duration)
                .attr('transform', d => `translate(${d.x},${d.y})`);

            nodeUpdate.select('rect')
                .attr('width', 100)
                .attr('height', 30)
                .attr('x', -50)
                .attr('y', -15)
                .attr('rx', 10)
                .attr('ry', 10)
                .attr('class', d => d._children ? 'has-children' : '')
                .style('fill', d => d._children ? "lightsteelblue" : "#fff")


            const nodeExit = node.exit().transition()
                .duration(duration)
                .attr('transform', d => `translate(${source.x},${source.y})`)
                .remove();

            nodeExit.select('rect')
                .attr('width', 100)
                .attr('height', 30)
                .attr('x', -50)
                .attr('y', -15)
                .attr('rx', 10)
                .attr('ry', 10);

            const link = svg.selectAll('path.link')
                .data(links, d => d.id);

            const linkEnter = link.enter().insert('path', 'g')
                .attr('class', 'link')
                .attr('d', d => {
                    const o = { x: source.x, y: source.y };
                    return `M${o.x},${o.y}V${o.y + 25}H${d.x}V${d.y}`;
                });

            const linkUpdate = linkEnter.merge(link);

            linkUpdate.transition()
                .duration(duration)
                .attr('d', d => `M${d.parent.x},${d.parent.y}V${d.parent.y + 25}H${d.x}V${d.y}`);

            const linkExit = link.exit().transition()
                .duration(duration)
                .attr('d', d => {
                    const o = { x: source.x, y: source.y };
                    return `M${o.x},${o.y}V${o.y + 25}H${d.x}V${d.y}`;
                })
                .remove();

            nodes.forEach(d => {
                d.x0 = d.x;
                d.y0 = d.y;
            });

            const offsetX = (svgWidth / 2) - root.x;
            const offsetY = margin.top - root.y;

            d3.select("g")
                .transition()
                .duration(duration)
                .attr("transform", `translate(${offsetX},${offsetY})`);
        }

        function click(event, d) {
            if (d.children) {
                d._children = d.children;
                d.children = null;
            } else {
                d.children = d._children;
                d._children = null;
            }
            update(d);
        }

        let expanded = false;

        function toggleTree() {
            if (expanded) {
                collapse(root);
            } else {
                expand(root);
            }
            expanded = !expanded;
            update(root);
        }


        update(root);
    </script>
</body>
</html>
